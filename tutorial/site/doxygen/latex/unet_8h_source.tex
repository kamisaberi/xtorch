\doxysection{unet.\+h}
\hypertarget{unet_8h_source}{}\label{unet_8h_source}\index{unet.h@{unet.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <torch/torch.h>}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}../../base.h"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../../../exceptions/implementation.h"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{namespace\ }xt::models\ \{}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{comment}{//class\ DoubleConv(nn.Module):}}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ \_\_init\_\_(self,\ in\_channels,\ out\_channels):}}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ super().\_\_init\_\_()}}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.conv\_op\ =\ nn.Sequential(}}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.Conv2d(in\_channels,\ out\_channels,\ kernel\_size=3,\ padding=1),}}
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.ReLU(inplace=True),}}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.Conv2d(out\_channels,\ out\_channels,\ kernel\_size=3,\ padding=1),}}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.ReLU(inplace=True)}}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ )}}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ forward(self,\ x):}}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ return\ self.conv\_op(x)}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{struct\ }DoubleConv\ :\ torch::nn::Module\ \{}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ DoubleConv(\textcolor{keywordtype}{int}\ in\_channels,\ \textcolor{keywordtype}{int}\ out\_channels);}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ torch::Tensor\ forward(torch::Tensor\ input);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ torch::nn::Sequential\ conv\_op\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00034\ \ \ \ \ \};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//class\ DownSample(nn.Module):}}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ \_\_init\_\_(self,\ in\_channels,\ out\_channels):}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ super().\_\_init\_\_()}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.conv\ =\ DoubleConv(in\_channels,\ out\_channels)}}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.pool\ =\ nn.MaxPool2d(kernel\_size=2,\ stride=2)}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ forward(self,\ x):}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ down\ =\ self.conv(x)}}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ p\ =\ self.pool(down)}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ return\ down,\ p}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{struct\ }DownSample\ :\ torch::nn::Module\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ DownSample(\textcolor{keywordtype}{int}\ in\_channels,\ \textcolor{keywordtype}{int}\ out\_channels);}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ torch::Tensor\ forward(torch::Tensor\ input);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DoubleConv}{DoubleConv}}\ conv\{0,\ 0\};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ torch::nn::MaxPool2d\ pool\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00057\ \ \ \ \ \};}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//class\ UpSample(nn.Module):}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ \_\_init\_\_(self,\ in\_channels,\ out\_channels):}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ super().\_\_init\_\_()}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.up\ =\ nn.ConvTranspose2d(in\_channels,\ in\_channels//2,\ kernel\_size=2,\ stride=2)}}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.conv\ =\ DoubleConv(in\_channels,\ out\_channels)}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ def\ forward(self,\ x1,\ x2):}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ x1\ =\ self.up(x1)}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ x\ =\ torch.cat([x1,\ x2],\ 1)}}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ return\ self.conv(x)}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{struct\ }UpSample\ :\ torch::nn::Module\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ UpSample(\textcolor{keywordtype}{int}\ in\_channels,\ \textcolor{keywordtype}{int}\ out\_channels);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ torch::Tensor\ forward(torch::Tensor\ x1,\ torch::Tensor\ x2);}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DoubleConv}{DoubleConv}}\ conv\{0,\ 0\};}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ torch::nn::ConvTranspose2d\ up\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00080\ \ \ \ \ \};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//class\ UNet(nn.Module):}}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ \_\_init\_\_(self,\ in\_channels,\ num\_classes):}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ super().\_\_init\_\_()}}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.down\_convolution\_1\ =\ DownSample(in\_channels,\ 64)}}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.down\_convolution\_2\ =\ DownSample(64,\ 128)}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.down\_convolution\_3\ =\ DownSample(128,\ 256)}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.down\_convolution\_4\ =\ DownSample(256,\ 512)}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.bottle\_neck\ =\ DoubleConv(512,\ 1024)}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.up\_convolution\_1\ =\ UpSample(1024,\ 512)}}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.up\_convolution\_2\ =\ UpSample(512,\ 256)}}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.up\_convolution\_3\ =\ UpSample(256,\ 128)}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.up\_convolution\_4\ =\ UpSample(128,\ 64)}}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ self.out\ =\ nn.Conv2d(in\_channels=64,\ out\_channels=num\_classes,\ kernel\_size=1)}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{comment}{//\ \ \ \ def\ forward(self,\ x):}}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ down\_1,\ p1\ =\ self.down\_convolution\_1(x)}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ down\_2,\ p2\ =\ self.down\_convolution\_2(p1)}}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ down\_3,\ p3\ =\ self.down\_convolution\_3(p2)}}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ down\_4,\ p4\ =\ self.down\_convolution\_4(p3)}}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ b\ =\ self.bottle\_neck(p4)}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00108\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ up\_1\ =\ self.up\_convolution\_1(b,\ down\_4)}}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ up\_2\ =\ self.up\_convolution\_2(up\_1,\ down\_3)}}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ up\_3\ =\ self.up\_convolution\_3(up\_2,\ down\_2)}}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ up\_4\ =\ self.up\_convolution\_4(up\_3,\ down\_1)}}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ out\ =\ self.out(up\_4)}}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ return\ out}}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keyword}{struct\ }UNet\ :\ BaseModel\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ UNet(\textcolor{keywordtype}{int}\ num\_classes\textcolor{comment}{/*\ classes\ */},\ \textcolor{keywordtype}{int}\ in\_channels\ =\ 1\textcolor{comment}{/*\ \ input\ channels\ */});}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ torch::Tensor\ forward(torch::Tensor\ input)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DownSample}{DownSample}}\ down\_convolution\_1\{0,0\};}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DownSample}{DownSample}}\ down\_convolution\_2\{0,0\};}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DownSample}{DownSample}}\ down\_convolution\_3\{0,0\};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DownSample}{DownSample}}\ down\_convolution\_4\{0,0\};}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1DoubleConv}{DoubleConv}}\ bottle\_neck\{0,0\};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1UpSample}{UpSample}}\ up\_convolution\_1\{0,0\};}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1UpSample}{UpSample}}\ up\_convolution\_2\{0,0\};}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1UpSample}{UpSample}}\ up\_convolution\_3\{0,0\};}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structxt_1_1models_1_1UpSample}{UpSample}}\ up\_convolution\_4\{0,0\};}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ torch::nn::Conv2d\ out\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00137\ \ \ \ \ \};}
\DoxyCodeLine{00138\ \}}

\end{DoxyCode}
